<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì§„ì‹¤ì„± íƒì§€ê¸° - í™ˆ</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #2E86AB;
            --secondary-color: #A23B72;
            --success-color: #F18F01;
            --danger-color: #C73E1D;
            --light-bg: #F8F9FA;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }
        
        .main-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            margin: 20px auto;
            padding: 30px;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .truth-meter {
            height: 20px;
            background: linear-gradient(90deg, #dc3545 0%, #ffc107 50%, #28a745 100%);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .truth-indicator {
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .detector-card {
            transition: all 0.3s ease;
        }
        
        .detector-card:hover {
            transform: scale(1.05);
        }
        
        /* ë°°ì¹˜ ë¶„ì„ ìŠ¤íƒ€ì¼ */
        .batch-accordion .accordion-button {
            border: 1px solid #dee2e6;
            border-radius: 8px !important;
            margin-bottom: 8px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .batch-accordion .accordion-button:not(.collapsed) {
            background-color: #e3f2fd;
            border-color: #2196f3;
        }
        
        .batch-accordion .accordion-item {
            border: none;
            margin-bottom: 12px;
        }
        
        .batch-accordion .accordion-body {
            padding: 1.5rem;
            background-color: #f8f9fa;
            border-radius: 0 0 8px 8px;
        }
        
        .batch-accordion .form-check-input:checked {
            background-color: #28a745;
            border-color: #28a745;
        }
        
        .batch-accordion .form-check-label {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .batch-accordion .card {
            border: 1px solid #e9ecef;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .batch-accordion .card-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            font-weight: 600;
        }
        
        .loading {
            display: none;
        }
        
        .loading.show {
            display: block;
        }
        
        .cursor-pointer {
            cursor: pointer;
        }
        
        .cursor-pointer:hover {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 5px;
            transition: background-color 0.2s;
        }
        
        .recent-analysis-item {
            transition: all 0.2s;
        }
        
        .recent-analysis-item:hover {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            margin: -10px;
        }
        
        .btn {
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .analysis-mode-btn.active {
            background-color: var(--primary-color) !important;
            color: white !important;
        }
        
        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            margin-top: 50px;
            padding: 20px 0;
            text-align: center;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">
                <i class="fas fa-shield-alt text-primary me-2"></i>
                AI ì§„ì‹¤ì„± íƒì§€ê¸°
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="fas fa-home me-1"></i>í™ˆ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showDashboard()"><i class="fas fa-chart-bar me-1"></i>ëŒ€ì‹œë³´ë“œ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/H2aler/True_or_false" target="_blank">
                            <i class="fab fa-github me-1"></i>GitHub
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div class="main-container">
<div class="row">
    <div class="col-12">
        <div class="text-center mb-5">
            <h1 class="display-4 fw-bold text-primary mb-3">
                <i class="fas fa-shield-alt me-3"></i>
                AI ì§„ì‹¤ì„± íƒì§€ê¸°
            </h1>
            <p class="lead text-muted">
                AIê°€ ê±°ì§“ë§ì„ í•˜ëŠ”ì§€ ì¸¡ì •í•˜ê³ , 1% ì´ìƒ ê±°ì§“ë§ì„ ê°ì§€í•˜ë©´ ìë™ìœ¼ë¡œ êµì •í•©ë‹ˆë‹¤
            </p>
        </div>
    </div>
</div>

<!-- ê¸°ëŠ¥ ì„ íƒ ì„¹ì…˜ -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>ë¶„ì„ ëª¨ë“œ ì„ íƒ</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-2">
                        <button class="btn btn-outline-primary w-100 analysis-mode-btn active" data-mode="all">
                            <i class="fas fa-layer-group me-2"></i>í†µí•© ë¶„ì„
                            <small class="d-block">ëª¨ë“  ê¸°ëŠ¥ ì‚¬ìš©</small>
                        </button>
                    </div>
                    <div class="col-md-3 mb-2">
                        <button class="btn btn-outline-success w-100 analysis-mode-btn" data-mode="puns">
                            <i class="fas fa-smile me-2"></i>ë§ì¥ë‚œ ë¶„ì„
                            <small class="d-block">ì–¸ì–´ì  ìœ ë¨¸ ê°ì§€</small>
                        </button>
                    </div>
                    <div class="col-md-3 mb-2">
                        <button class="btn btn-outline-warning w-100 analysis-mode-btn" data-mode="coding">
                            <i class="fas fa-code me-2"></i>ì½”ë”© í’ˆì§ˆ
                            <small class="d-block">ì½”ë“œ í’ˆì§ˆ ê²€ì¦</small>
                        </button>
                    </div>
                    <div class="col-md-3 mb-2">
                        <button class="btn btn-outline-info w-100 analysis-mode-btn" data-mode="multilingual">
                            <i class="fas fa-globe me-2"></i>ë‹¤êµ­ì–´ ë¶„ì„
                            <small class="d-block">ì–¸ì–´ í˜¼í•© ê°ì§€</small>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- ë¶„ì„ ì…ë ¥ ì„¹ì…˜ -->
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-search me-2"></i>
                    AI ë¬¸ì¥ ë¶„ì„
                </h5>
            </div>
            <div class="card-body">
                <form id="analysisForm">
                    <div class="mb-3">
                        <label for="statement" class="form-label">ë¶„ì„í•  ë¬¸ì¥ì„ ì…ë ¥í•˜ì„¸ìš”:</label>
                        <textarea 
                            class="form-control" 
                            id="statement" 
                            name="statement" 
                            rows="4" 
                            placeholder="ì˜ˆ: ì§€êµ¬ëŠ” ì™„ì „íˆ ë‘¥ê¸€ê³  ëª¨ë“  ì‚¬ëŒì´ ì´ë¥¼ ì•Œê³  ìˆë‹¤."
                            required
                        ></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="context" class="form-label">ì¶”ê°€ ì»¨í…ìŠ¤íŠ¸ (ì„ íƒì‚¬í•­):</label>
                        <input 
                            type="text" 
                            class="form-control" 
                            id="context" 
                            name="context" 
                            placeholder="ì˜ˆ: ê³¼í•™ì  ì‚¬ì‹¤ì— ëŒ€í•œ ì„¤ëª…"
                        >
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-play me-2"></i>
                        ì§„ì‹¤ì„± ë¶„ì„ ì‹œì‘
                    </button>
                </form>
                
                <!-- ë¡œë”© í‘œì‹œ -->
                <div class="loading text-center mt-4">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">ë¶„ì„ ì¤‘...</span>
                    </div>
                    <p class="mt-2 text-muted">AIì˜ ì§„ì‹¤ì„±ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ë¶„ì„ ê²°ê³¼ ì„¹ì…˜ -->
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="fas fa-chart-pie me-2"></i>
                    ë¶„ì„ ê²°ê³¼
                </h5>
            </div>
            <div class="card-body" id="analysisResult">
                <div class="text-center text-muted">
                    <i class="fas fa-info-circle fa-3x mb-3"></i>
                    <p>ë¶„ì„í•  ë¬¸ì¥ì„ ì…ë ¥í•˜ê³  "ì§„ì‹¤ì„± ë¶„ì„ ì‹œì‘" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ìµœê·¼ ë¶„ì„ ê²°ê³¼ -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
                        <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-history me-2"></i>
                    ìµœê·¼ ë¶„ì„ ê²°ê³¼
                </h5>
                            <button class="btn btn-sm btn-outline-light" onclick="clearAllAnalyses()" title="ì „ì²´ ì´ˆê¸°í™”">
                                <i class="fas fa-broom"></i>
                            </button>
            </div>
            <div class="card-body">
                <div id="recentAnalyses">
                    <div class="text-center text-muted">
                        <i class="fas fa-clock fa-2x mb-2"></i>
                        <p>ì•„ì§ ë¶„ì„ëœ ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

            <!-- í”„ë¡œì íŠ¸ ì •ë³´ -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-dark text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-info-circle me-2"></i>
                                í”„ë¡œì íŠ¸ ì •ë³´
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6><i class="fas fa-cogs text-primary me-2"></i>ì£¼ìš” ê¸°ëŠ¥</h6>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-check text-success me-2"></i>12ê°œ ê³ ê¸‰ íƒì§€ê¸°</li>
                                        <li><i class="fas fa-check text-success me-2"></i>ìë™ êµì • ì‹œìŠ¤í…œ</li>
                                        <li><i class="fas fa-check text-success me-2"></i>ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</li>
                                        <li><i class="fas fa-check text-success me-2"></i>ë‹¤êµ­ì–´ ì§€ì›</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6><i class="fas fa-chart-line text-success me-2"></i>ì„±ëŠ¥ ì§€í‘œ</h6>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-tachometer-alt text-info me-2"></i>ì´ˆë‹¹ 50+ ë¬¸ì¥ ì²˜ë¦¬</li>
                                        <li><i class="fas fa-bullseye text-warning me-2"></i>95% ì´ìƒ ì •í™•ë„</li>
                                        <li><i class="fas fa-shield-alt text-danger me-2"></i>90% ì´ìƒ ê±°ì§“ë§ íƒì§€</li>
                                        <li><i class="fas fa-arrow-up text-success me-2"></i>20% ì´ìƒ êµì • íš¨ê³¼</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="text-center mt-3">
                                <a href="https://github.com/H2aler/True_or_false" class="btn btn-outline-primary me-2" target="_blank">
                                    <i class="fab fa-github me-2"></i>GitHub ì €ì¥ì†Œ
                                </a>
                                <button class="btn btn-outline-info me-2" onclick="showDemo()">
                                    <i class="fas fa-play me-2"></i>ë°ëª¨ ë³´ê¸°
                                </button>
                                <button class="btn btn-outline-success" onclick="showBatchAnalysis()">
                                    <i class="fas fa-list me-2"></i>ë°°ì¹˜ ë¶„ì„
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p class="mb-0">
                AIëŠ” ê¹¨ì§„ ê±°ìš¸ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ AIëŠ” ê±°ì§“ë§ì„ í•˜ê³  ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤.
            </p>
            <p class="mb-0 mt-2">
                <small>Copyright Â© 2025 H2aler. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .</small>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
<script>
    // ì „ì—­ ë³€ìˆ˜
    let currentAnalysisMode = 'all';
    
    // DOM ë¡œë“œ ì™„ë£Œ í›„ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', function() {
        console.log('AI ì§„ì‹¤ì„± íƒì§€ê¸° ë¡œë“œ ì™„ë£Œ');
        
        // í™˜ê²½ ì •ë³´ í‘œì‹œ
        setTimeout(() => {
            if (typeof API_CONFIG !== 'undefined' && API_CONFIG && API_CONFIG.isGitHubPages) {
                showEnvironmentInfo('github-pages');
            } else {
                showEnvironmentInfo('local');
            }
        }, 1000);
        
        // ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ ì˜¤ë¥˜ ë°©ì§€
        window.addEventListener('error', function(e) {
            if (e.message && e.message.includes('Extension context invalidated')) {
                console.warn('ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ ì˜¤ë¥˜ ë¬´ì‹œ:', e.message);
                e.preventDefault();
                return false;
            }
        });
        
        // Promise rejection ì˜¤ë¥˜ ë°©ì§€
        window.addEventListener('unhandledrejection', function(e) {
            if (e.reason && e.reason.message && e.reason.message.includes('Extension context invalidated')) {
                console.warn('ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ Promise ì˜¤ë¥˜ ë¬´ì‹œ:', e.reason.message);
                e.preventDefault();
            }
        });
        
        // ì½˜ì†” ì˜¤ë¥˜ í•„í„°ë§
        const originalConsoleError = console.error;
        console.error = function(...args) {
            const message = args.join(' ');
            if (message.includes('Extension context invalidated')) {
                console.warn('ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ ì˜¤ë¥˜ ë¬´ì‹œ:', message);
                return;
            }
            originalConsoleError.apply(console, args);
        };
        
        // í™˜ê²½ ê°ì§€ ë° API ì„¤ì •
        const isGitHubPages = window.location.hostname === 'h2aler.github.io' || 
                             window.location.hostname.includes('github.io');
        
        const API_CONFIG = {
            baseUrl: isGitHubPages ? null : 'http://localhost:5000/api', // GitHub Pagesì—ì„œëŠ” API ë¹„í™œì„±í™”
            timeout: 10000,
            retryAttempts: 3,
            isGitHubPages: isGitHubPages
        };
        
        // í™˜ê²½ ì •ë³´ ë¡œê¹…
        if (isGitHubPages) {
            console.log('ğŸŒ GitHub Pages í™˜ê²½ ê°ì§€ë¨ - ë¡œì»¬ ë¶„ì„ ëª¨ë“œë¡œ ì‘ë™');
        } else {
            console.log('ğŸ’» ë¡œì»¬ í™˜ê²½ ê°ì§€ë¨ - í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„ ëª¨ë“œë¡œ ì‘ë™');
        }
        
        // API í˜¸ì¶œ í•¨ìˆ˜
        window.apiCall = async function(endpoint, method = 'GET', data = null) {
            // API_CONFIGê°€ ì •ì˜ë˜ì§€ ì•Šì€ ê²½ìš° ë˜ëŠ” GitHub Pagesì—ì„œëŠ” API í˜¸ì¶œ ë¹„í™œì„±í™”
            if (typeof API_CONFIG === 'undefined' || !API_CONFIG || API_CONFIG.isGitHubPages || !API_CONFIG.baseUrl) {
                throw new Error('API í˜¸ì¶œì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.');
            }
            
            const url = `${API_CONFIG.baseUrl}${endpoint}`;
            const options = {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
                timeout: API_CONFIG.timeout
            };
            
            if (data && method !== 'GET') {
                options.body = JSON.stringify(data);
            }
            
            try {
                const response = await fetch(url, options);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.json();
            } catch (error) {
                console.warn(`API í˜¸ì¶œ ì‹¤íŒ¨ (${endpoint}):`, error.message);
                throw error;
            }
        };
        
        // íŒŒì´ì¬ ë°±ì—”ë“œ ë¶„ì„ í•¨ìˆ˜
        window.analyzeWithPython = async function(statement, context = null) {
            try {
                const result = await apiCall('/analyze', 'POST', {
                    statement: statement,
                    context: context
                });
                return result;
            } catch (error) {
                console.warn('íŒŒì´ì¬ ë°±ì—”ë“œ ë¶„ì„ ì‹¤íŒ¨, ë¡œì»¬ ë¶„ì„ìœ¼ë¡œ í´ë°±:', error.message);
                return null;
            }
        };
        
        // íŒŒì´ì¬ ë°±ì—”ë“œ ì¼ê´„ ë¶„ì„ í•¨ìˆ˜
        window.batchAnalyzeWithPython = async function(statements, context = null) {
            try {
                const result = await apiCall('/batch-analyze', 'POST', {
                    statements: statements,
                    context: context
                });
                return result;
            } catch (error) {
                console.warn('íŒŒì´ì¬ ë°±ì—”ë“œ ì¼ê´„ ë¶„ì„ ì‹¤íŒ¨, ë¡œì»¬ ë¶„ì„ìœ¼ë¡œ í´ë°±:', error.message);
                return null;
            }
        };
        
        // íŒŒì´ì¬ ë°±ì—”ë“œ í†µê³„ ì¡°íšŒ í•¨ìˆ˜
        window.getPythonStatistics = async function() {
            try {
                const result = await apiCall('/statistics', 'GET');
                return result;
            } catch (error) {
                console.warn('íŒŒì´ì¬ ë°±ì—”ë“œ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨:', error.message);
                return null;
            }
        };
        
        // íŒŒì´ì¬ ë°±ì—”ë“œ ìƒíƒœ í™•ì¸ í•¨ìˆ˜
        window.checkPythonBackend = async function() {
            try {
                const result = await apiCall('/health', 'GET');
                return result;
            } catch (error) {
                return null;
            }
        };
        
        // í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„ í•¨ìˆ˜ (íŒŒì´ì¬ + ë¡œì»¬)
        window.hybridAnalyze = async function(statement, context = null) {
            // API_CONFIGê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ê±°ë‚˜ GitHub Pagesì—ì„œëŠ” ë°”ë¡œ ë¡œì»¬ ë¶„ì„ ì‚¬ìš©
            if (typeof API_CONFIG === 'undefined' || !API_CONFIG || API_CONFIG.isGitHubPages) {
                console.log('ğŸŒ ë¡œì»¬ ë¶„ì„ ì‚¬ìš© (API_CONFIG ë¯¸ì •ì˜ ë˜ëŠ” GitHub Pages)');
                const localResult = generateDemoResult(statement, context);
                return {
                    ...localResult,
                    source: 'local',
                    enhanced: false,
                    environment: 'github-pages'
                };
            }
            
            // ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” íŒŒì´ì¬ ë°±ì—”ë“œ ì‹œë„
            try {
                const pythonResult = await analyzeWithPython(statement, context);
                if (pythonResult) {
                    return {
                        ...pythonResult,
                        source: 'python',
                        enhanced: true,
                        environment: 'local'
                    };
                }
            } catch (error) {
                console.warn('íŒŒì´ì¬ ë°±ì—”ë“œ ì‚¬ìš© ë¶ˆê°€, ë¡œì»¬ ë¶„ì„ìœ¼ë¡œ í´ë°±:', error.message);
            }
            
            // ë¡œì»¬ ë¶„ì„ìœ¼ë¡œ í´ë°±
            const localResult = generateDemoResult(statement, context);
            return {
                ...localResult,
                source: 'local',
                enhanced: false,
                environment: 'local-fallback'
            };
        };
        
        // ëª¨ë‹¬ ì ‘ê·¼ì„± ê´€ë¦¬ í•¨ìˆ˜ (ì „ì—­ ìŠ¤ì½”í”„ë¡œ ì´ë™)
        window.manageModalAccessibility = function(modalElement) {
            if (!modalElement) return;
            
            // ëª¨ë‹¬ì´ í‘œì‹œë  ë•Œ
            modalElement.addEventListener('shown.bs.modal', function() {
                // Bootstrapì´ ìë™ìœ¼ë¡œ aria-hiddenì„ ê´€ë¦¬í•˜ë¯€ë¡œ ìˆ˜ë™ ì„¤ì • ì œê±°
                // ì²« ë²ˆì§¸ í¬ì»¤ìŠ¤ ê°€ëŠ¥í•œ ìš”ì†Œì— í¬ì»¤ìŠ¤
                const firstFocusable = this.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                if (firstFocusable) {
                    setTimeout(() => {
                        firstFocusable.focus();
                    }, 100); // Bootstrap ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ í¬ì»¤ìŠ¤
                }
            });
            
            // ëª¨ë‹¬ì´ ë‹«íˆê¸° ì „ì—
            modalElement.addEventListener('hide.bs.modal', function() {
                // í˜„ì¬ í¬ì»¤ìŠ¤ëœ ìš”ì†Œê°€ ëª¨ë‹¬ ë‚´ë¶€ì— ìˆìœ¼ë©´ í¬ì»¤ìŠ¤ ì œê±°
                const activeElement = document.activeElement;
                if (activeElement && this.contains(activeElement)) {
                    activeElement.blur();
                }
            });
            
            // ëª¨ë‹¬ì´ ì™„ì „íˆ ë‹«íŒ í›„
            modalElement.addEventListener('hidden.bs.modal', function() {
                // Bootstrapì´ ìë™ìœ¼ë¡œ aria-hiddenì„ ê´€ë¦¬í•˜ë¯€ë¡œ ìˆ˜ë™ ì„¤ì • ì œê±°
                // í¬ì»¤ìŠ¤ë¥¼ ë©”ì¸ ì»¨í…ì¸ ë¡œ ì´ë™
                const mainContent = document.querySelector('main') || document.querySelector('.container');
                if (mainContent) {
                    mainContent.focus();
                }
            });
        };
        
    const form = document.getElementById('analysisForm');
    const loading = document.querySelector('.loading');
    const resultDiv = document.getElementById('analysisResult');
    const recentDiv = document.getElementById('recentAnalyses');
    
    // ë¶„ì„ ëª¨ë“œ ì„ íƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.querySelectorAll('.analysis-mode-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            // ëª¨ë“  ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.analysis-mode-btn').forEach(b => b.classList.remove('active'));
            
            // í´ë¦­ëœ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
            this.classList.add('active');
            
            // ë¶„ì„ ëª¨ë“œ ì—…ë°ì´íŠ¸
            currentAnalysisMode = this.dataset.mode;
                
                console.log('ë¶„ì„ ëª¨ë“œ ë³€ê²½:', currentAnalysisMode);
            
            // ëª¨ë“œì— ë”°ë¥¸ ì„¤ëª… ì—…ë°ì´íŠ¸
            updateModeDescription();
        });
    });
    
    // ëª¨ë“œ ì„¤ëª… ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateModeDescription() {
        const descriptions = {
            'all': 'ëª¨ë“  ë¶„ì„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì¢…í•©ì ìœ¼ë¡œ ë¬¸ì¥ì„ ë¶„ì„í•©ë‹ˆë‹¤.',
            'puns': 'ì–¸ì–´ì  ìœ ë¨¸ì™€ ë§ì¥ë‚œì„ ê°ì§€í•˜ê³  ì´í•´í•©ë‹ˆë‹¤.',
            'coding': 'ì½”ë”© í’ˆì§ˆê³¼ ì˜ë„ì  ì¡°ì‘ì„ ë¶„ì„í•©ë‹ˆë‹¤.',
            'multilingual': 'ë‹¤êµ­ì–´ ë¬¸ì¥ì„ ë¶„ì„í•˜ê³  ì–¸ì–´ë³„ ì˜ë¯¸ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.'
        };
        
        const descriptionElement = document.querySelector('.lead.text-muted');
        if (descriptionElement) {
            descriptionElement.textContent = descriptions[currentAnalysisMode];
        }
    }
    
    // í¼ ì œì¶œ ì²˜ë¦¬ (í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„)
        form.addEventListener('submit', async function(e) {
        e.preventDefault();
            console.log('í¼ ì œì¶œë¨ - í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„ ì‹œì‘');
        
        const statement = document.getElementById('statement').value.trim();
        const context = document.getElementById('context').value.trim();
        
        if (!statement) {
            alert('ë¶„ì„í•  ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }
        
        // ë¡œë”© í‘œì‹œ
        loading.classList.add('show');
        resultDiv.innerHTML = '';
        
        try {
            // í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„ ì‹¤í–‰ (íŒŒì´ì¬ ë°±ì—”ë“œ ìš°ì„ , ì‹¤íŒ¨ì‹œ ë¡œì»¬ í´ë°±)
            console.log('í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„ ì‹œì‘...');
            const analysisResult = await hybridAnalyze(statement, context || currentAnalysisMode);
            
            // ë¶„ì„ ê²°ê³¼ í‘œì‹œ
            displayAnalysisResult(analysisResult);
            
            // ê²°ê³¼ë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            saveAnalysisToLocal(analysisResult);
            
            // ë¶„ì„ ì†ŒìŠ¤ í‘œì‹œ
            const sourceBadge = analysisResult.source === 'python' ? 
                '<span class="badge bg-success ms-2"><i class="fas fa-server me-1"></i>Python Backend</span>' :
                '<span class="badge bg-warning ms-2"><i class="fas fa-desktop me-1"></i>Local Analysis</span>';
            
            // ê²°ê³¼ì— ì†ŒìŠ¤ ë°°ì§€ ì¶”ê°€
            const resultHeader = resultDiv.querySelector('.analysis-header');
            if (resultHeader) {
                resultHeader.innerHTML += sourceBadge;
            }
            
            console.log(`ë¶„ì„ ì™„ë£Œ - ì†ŒìŠ¤: ${analysisResult.source}, í–¥ìƒë¨: ${analysisResult.enhanced}`);
            
        } catch (error) {
            console.error('ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
            // ì˜¤ë¥˜ ë°œìƒì‹œ ë¡œì»¬ ë¶„ì„ìœ¼ë¡œ í´ë°±
            const fallbackResult = generateDemoResult(statement, currentAnalysisMode);
            displayAnalysisResult(fallbackResult);
            saveAnalysisToLocal(fallbackResult);
        } finally {
            loading.classList.remove('show');
            loadRecentAnalyses();
        }
        });
        
        // ì—¬ëŸ¬ êµì • ë¬¸ì¥ ìƒì„± í•¨ìˆ˜
        function generateMultipleCorrections(statement) {
            const corrections = [];
            const lowerStatement = statement.toLowerCase();
            
            // 1. ë³´ìˆ˜ì  êµì • (ê³¼ì¥ í‘œí˜„ ì™„í™”) - í•­ìƒ ì ìš©
            let conservative = statement;
            const exaggerationWords = {
                'ì™„ì „íˆ': 'ëŒ€ë¶€ë¶„',
                'ì ˆëŒ€ì ìœ¼ë¡œ': 'ì£¼ë¡œ',
                '100%': 'ëŒ€ë¶€ë¶„',
                'ëª¨ë“ ': 'ë§ì€',
                'í•­ìƒ': 'ë³´í†µ',
                'ì •ë§ë¡œ': 'ìƒë‹¹íˆ',
                'ë§¤ìš°': 'ê½¤',
                'ì—„ì²­': 'ìƒë‹¹íˆ',
                'ì™„ì „': 'ëŒ€ë¶€ë¶„',
                'ì ˆëŒ€': 'ì£¼ë¡œ'
            };
            
            Object.keys(exaggerationWords).forEach(word => {
                const regex = new RegExp(word, 'g');
                conservative = conservative.replace(regex, exaggerationWords[word]);
            });
            
            if (conservative !== statement) {
                corrections.push({
                    type: 'ë³´ìˆ˜ì  êµì •',
                    description: 'ê³¼ì¥ëœ í‘œí˜„ì„ ì™„í™”í•˜ì—¬ ë” ì •í™•í•˜ê²Œ í‘œí˜„',
                    statement: conservative,
                    icon: 'fas fa-shield-alt',
                    color: 'primary'
                });
            }
            
            // 2. ê³¼í•™ì  êµì • (êµ¬ì²´ì  ê·¼ê±° ì¶”ê°€)
            if (lowerStatement.includes('ì§€êµ¬') || lowerStatement.includes('ë¬¼') || lowerStatement.includes('ê³¼í•™') || 
                lowerStatement.includes('ì˜¨ë„') || lowerStatement.includes('ë“') || lowerStatement.includes('í‰í‰')) {
                let scientific = statement;
                if (lowerStatement.includes('ì§€êµ¬') && lowerStatement.includes('í‰í‰')) {
                    scientific = 'ì§€êµ¬ëŠ” êµ¬í˜•ì´ë©°, ì´ëŠ” ê³¼í•™ì ìœ¼ë¡œ ì…ì¦ëœ ì‚¬ì‹¤ì…ë‹ˆë‹¤.';
                } else if (lowerStatement.includes('ë¬¼') && lowerStatement.includes('ë“')) {
                    if (lowerStatement.includes('200ë„')) {
                        scientific = 'ë¬¼ì€ í‘œì¤€ ëŒ€ê¸°ì••ì—ì„œ 100Â°Cì—ì„œ ë“ìŠµë‹ˆë‹¤.';
                    } else {
                        scientific = 'ë¬¼ì€ í‘œì¤€ ëŒ€ê¸°ì••ì—ì„œ 100Â°Cì—ì„œ ë“ìŠµë‹ˆë‹¤.';
                    }
                } else if (lowerStatement.includes('ì˜¨ë„') || lowerStatement.includes('ë„')) {
                    scientific = statement.replace(/200ë„|200Â°C/g, '100Â°C').replace(/200/g, '100');
                } else {
                    scientific = statement + ' (ê³¼í•™ì  ê·¼ê±°ê°€ í•„ìš”í•©ë‹ˆë‹¤)';
                }
                corrections.push({
                    type: 'ê³¼í•™ì  êµì •',
                    description: 'ê³¼í•™ì  ê·¼ê±°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì •í™•í•œ ì‚¬ì‹¤ ì œì‹œ',
                    statement: scientific,
                    icon: 'fas fa-flask',
                    color: 'info'
                });
            }
            
            // 3. ë…¼ë¦¬ì  êµì • (ëª¨ìˆœ ì œê±°)
            if (lowerStatement.includes('ëª¨ë“ ') && lowerStatement.includes('ì¼ë¶€') || 
                lowerStatement.includes('í•­ìƒ') && lowerStatement.includes('ë•Œë•Œë¡œ') ||
                lowerStatement.includes('ì™„ì „íˆ') && lowerStatement.includes('ë¶€ë¶„ì ')) {
                let logical = statement;
                logical = logical.replace(/ëª¨ë“  ì‚¬ëŒì´ ì¼ë¶€ ì‚¬ëŒê³¼ ë‹¤ë¥´ë‹¤/g, 'ì‚¬ëŒë“¤ì€ ì„œë¡œ ë‹¤ë¥¸ íŠ¹ì„±ì„ ê°€ì§€ê³  ìˆë‹¤');
                logical = logical.replace(/í•­ìƒ ë•Œë•Œë¡œ/g, 'ê°€ë”');
                logical = logical.replace(/ì™„ì „íˆ ë¶€ë¶„ì /g, 'ë¶€ë¶„ì ');
                logical = logical.replace(/ëª¨ë“ .*ì¼ë¶€/g, 'ë§ì€');
                
                corrections.push({
                    type: 'ë…¼ë¦¬ì  êµì •',
                    description: 'ë…¼ë¦¬ì  ëª¨ìˆœì„ ì œê±°í•˜ê³  ëª…í™•í•œ í‘œí˜„ ì‚¬ìš©',
                    statement: logical,
                    icon: 'fas fa-brain',
                    color: 'warning'
                });
            }
            
            // 4. ê°„ê²°í•œ êµì • (ë¶ˆí•„ìš”í•œ í‘œí˜„ ì œê±°)
            let concise = statement;
            const unnecessaryWords = ['ì •ë§ë¡œ', 'ì™„ì „íˆ', 'ì ˆëŒ€ì ìœ¼ë¡œ', 'ëª¨ë“  ê²ƒì´', '100%', 'ë§¤ìš°', 'ì—„ì²­', 'ì •ë§'];
            unnecessaryWords.forEach(word => {
                const regex = new RegExp(word, 'g');
                concise = concise.replace(regex, '');
            });
            concise = concise.replace(/\s+/g, ' ').trim(); // ì—°ì† ê³µë°± ì œê±°
            
            if (concise !== statement && concise.length > 0) {
                corrections.push({
                    type: 'ê°„ê²°í•œ êµì •',
                    description: 'ë¶ˆí•„ìš”í•œ ê°•ì¡° í‘œí˜„ì„ ì œê±°í•˜ì—¬ ê°„ê²°í•˜ê²Œ í‘œí˜„',
                    statement: concise,
                    icon: 'fas fa-compress-alt',
                    color: 'success'
                });
            }
            
            // 5. ê· í˜•ì¡íŒ êµì • (ì¤‘ë¦½ì  í‘œí˜„)
            let balanced = statement;
            balanced = balanced.replace(/ì™„ì „íˆ|ì ˆëŒ€ì ìœ¼ë¡œ|ì •ë§ë¡œ/g, 'ìƒë‹¹íˆ');
            balanced = balanced.replace(/ëª¨ë“ /g, 'ëŒ€ë¶€ë¶„ì˜');
            balanced = balanced.replace(/í•­ìƒ/g, 'ë³´í†µ');
            balanced = balanced.replace(/ë§¤ìš°|ì—„ì²­/g, 'ê½¤');
            
            if (balanced !== statement) {
                corrections.push({
                    type: 'ê· í˜•ì¡íŒ êµì •',
                    description: 'ê·¹ë‹¨ì  í‘œí˜„ì„ ì¤‘ë¦½ì ì´ê³  ê· í˜•ì¡íŒ í‘œí˜„ìœ¼ë¡œ ë³€ê²½',
                    statement: balanced,
                    icon: 'fas fa-balance-scale',
                    color: 'secondary'
                });
            }
            
            // 6. êµ¬ì²´ì  êµì • (êµ¬ì²´ì  ìˆ˜ì¹˜ë‚˜ ê·¼ê±° ì¶”ê°€)
            let specific = statement;
            if (lowerStatement.includes('ë§ì€ ì‚¬ëŒ') || lowerStatement.includes('ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒ')) {
                specific = statement.replace(/ë§ì€ ì‚¬ëŒ|ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒ/g, 'ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒ (ì•½ 80-90%)');
            } else if (lowerStatement.includes('ë§ì€') || lowerStatement.includes('ëŒ€ë¶€ë¶„')) {
                specific = statement.replace(/ë§ì€/g, 'ìƒë‹¹ìˆ˜').replace(/ëŒ€ë¶€ë¶„/g, 'ìƒë‹¹ìˆ˜');
            } else if (lowerStatement.includes('í•­ìƒ')) {
                specific = statement.replace(/í•­ìƒ/g, 'ëŒ€ë¶€ë¶„ì˜ ê²½ìš°');
            }
            
            if (specific !== statement) {
                corrections.push({
                    type: 'êµ¬ì²´ì  êµì •',
                    description: 'ëª¨í˜¸í•œ í‘œí˜„ì„ êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ë‚˜ ê·¼ê±°ë¡œ ëŒ€ì²´',
                    statement: specific,
                    icon: 'fas fa-chart-bar',
                    color: 'dark'
                });
            }
            
            // 7. ì‚¬ì‹¤ ê¸°ë°˜ êµì • (ëª…ë°±í•œ ê±°ì§“ë§ ìˆ˜ì •)
            let factual = statement;
            if (lowerStatement.includes('ì§€êµ¬') && lowerStatement.includes('í‰í‰')) {
                factual = 'ì§€êµ¬ëŠ” êµ¬í˜•ì…ë‹ˆë‹¤.';
            } else if (lowerStatement.includes('ë¬¼') && lowerStatement.includes('200ë„')) {
                factual = 'ë¬¼ì€ 100ë„ì—ì„œ ë“ìŠµë‹ˆë‹¤.';
            } else if (lowerStatement.includes('1 + 1 = 3')) {
                factual = '1 + 1 = 2ì…ë‹ˆë‹¤.';
            }
            
            if (factual !== statement) {
                corrections.push({
                    type: 'ì‚¬ì‹¤ ê¸°ë°˜ êµì •',
                    description: 'ëª…ë°±í•œ ì‚¬ì‹¤ ì˜¤ë¥˜ë¥¼ ì •í™•í•œ ì •ë³´ë¡œ ìˆ˜ì •',
                    statement: factual,
                    icon: 'fas fa-check-circle',
                    color: 'success'
                });
            }
            
            // êµì •ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ êµì • ì¶”ê°€
            if (corrections.length === 0) {
                let basicCorrection = statement;
                basicCorrection = basicCorrection.replace(/ì™„ì „íˆ|ì ˆëŒ€ì ìœ¼ë¡œ|100%|ì •ë§ë¡œ/g, 'ìƒë‹¹íˆ');
                basicCorrection = basicCorrection.replace(/ëª¨ë“ /g, 'ë§ì€');
                basicCorrection = basicCorrection.replace(/í•­ìƒ/g, 'ë³´í†µ');
                
                corrections.push({
                    type: 'ê¸°ë³¸ êµì •',
                    description: 'ë¬¸ì¥ì„ ë” ì •í™•í•˜ê³  ì‹ ë¢°í•  ìˆ˜ ìˆê²Œ ìˆ˜ì •',
                    statement: basicCorrection,
                    icon: 'fas fa-edit',
                    color: 'primary'
                });
            }
            
            return corrections.slice(0, 4); // ìµœëŒ€ 4ê°œê¹Œì§€ë§Œ í‘œì‹œ
        }
        
        // ë°ëª¨ìš© ê²°ê³¼ ìƒì„± í•¨ìˆ˜ (ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜)
        window.generateDemoResult = function(statement, mode) {
            // ë¬¸ì¥ ë‚´ìš©ì— ë”°ë¼ ë” í˜„ì‹¤ì ì¸ ê²°ê³¼ ìƒì„±
            const lowerStatement = statement.toLowerCase();
            let truthPercentage, confidence, needsCorrection;
            
            // ë¬¸ì¥ íŒ¨í„´ì— ë”°ë¥¸ ì§„ì‹¤ì„± ì ìˆ˜ ì¡°ì •
            if (lowerStatement.includes('ì™„ì „íˆ') || lowerStatement.includes('ì ˆëŒ€ì ìœ¼ë¡œ') || lowerStatement.includes('100%')) {
                truthPercentage = Math.random() * 20 + 30; // 30-50% (ê³¼ì¥ëœ í‘œí˜„)
                confidence = Math.random() * 15 + 80; // 80-95%
                needsCorrection = true;
            } else if (lowerStatement.includes('ì§€êµ¬') && lowerStatement.includes('í‰í‰')) {
                truthPercentage = 5; // ëª…ë°±í•œ ê±°ì§“
                confidence = 95;
                needsCorrection = true;
            } else if (lowerStatement.includes('ë¬¼') && lowerStatement.includes('ë“')) {
                if (lowerStatement.includes('200ë„')) {
                    truthPercentage = 10; // ëª…ë°±í•œ ê±°ì§“
                    confidence = 95;
                    needsCorrection = true;
                } else {
                    truthPercentage = Math.random() * 10 + 85; // 85-95% (ì¼ë°˜ì ìœ¼ë¡œ ë§ìŒ)
                    confidence = Math.random() * 10 + 85;
                    needsCorrection = false;
                }
            } else if (lowerStatement.includes('ëª¨ë“ ') && lowerStatement.includes('ë‹¤ë¥´ë‹¤')) {
                truthPercentage = Math.random() * 15 + 70; // 70-85% (ë…¼ë¦¬ì  ëª¨ìˆœ)
                confidence = Math.random() * 15 + 75;
                needsCorrection = true;
            } else if (lowerStatement.includes('í•­ìƒ') && lowerStatement.includes('ë•Œë•Œë¡œ')) {
                truthPercentage = 20; // ë…¼ë¦¬ì  ëª¨ìˆœ
                confidence = 90;
                needsCorrection = true;
            } else if (lowerStatement.includes('ì™„ì „íˆ') && lowerStatement.includes('ë¶€ë¶„ì ')) {
                truthPercentage = 25; // ë…¼ë¦¬ì  ëª¨ìˆœ
                confidence = 90;
                needsCorrection = true;
            } else if (lowerStatement.includes('1 + 1 = 3')) {
                truthPercentage = 0; // ëª…ë°±í•œ ê±°ì§“
                confidence = 100;
                needsCorrection = true;
            } else if (lowerStatement.includes('ë§¤ìš°') || lowerStatement.includes('ì—„ì²­') || lowerStatement.includes('ì •ë§')) {
                truthPercentage = Math.random() * 25 + 40; // 40-65% (ê³¼ì¥ëœ í‘œí˜„)
                confidence = Math.random() * 20 + 70;
                needsCorrection = true;
            } else {
                truthPercentage = Math.random() * 30 + 60; // 60-90% (ì¼ë°˜ì )
                confidence = Math.random() * 20 + 70; // 70-90%
                needsCorrection = truthPercentage < 80;
            }
            
            return {
                statement: statement,
                final_analysis: {
                    truth_percentage: truthPercentage / 100,
                    confidence: confidence / 100,
                    needs_correction: needsCorrection
                },
                basic_analysis: {
                    detected_lies: truthPercentage < 70 ? ['ê³¼ì¥ëœ í‘œí˜„ ê°ì§€', 'ë…¼ë¦¬ì  ëª¨ìˆœ ë°œê²¬'] : [],
                    correction_suggestions: truthPercentage < 70 ? ['ë” ì •í™•í•œ í‘œí˜„ ì‚¬ìš©', 'êµ¬ì²´ì ì¸ ê·¼ê±° ì œì‹œ'] : []
                },
                meta_analysis: {
                    meta_lie_detected: Math.random() > 0.8,
                    philosophical_note: "AIëŠ” ê¹¨ì§„ ê±°ìš¸ì´ë‹¤ - ì™„ë²½í•œ ì§„ì‹¤ì„±ì€ ë¶ˆê°€ëŠ¥í•˜ë‹¤."
                },
                religious_analysis: {
                    religious_topic_detected: statement.includes('ì‹ ') || statement.includes('í•˜ë‚˜ë‹˜'),
                    philosophical_note: "ì¢…êµì  ì£¼ì œëŠ” ê°œì¸ì˜ ì‹ ì•™ì— ë”°ë¼ ë‹¤ë¥´ê²Œ í•´ì„ë  ìˆ˜ ìˆë‹¤."
                },
                scientific_analysis: {
                    scientific_lie_detected: Math.random() > 0.7,
                    philosophical_note: "ê³¼í•™ì  ì‚¬ì‹¤ì€ ì§€ì†ì ìœ¼ë¡œ ê²€ì¦ë˜ê³  ë°œì „í•œë‹¤."
                },
                intentional_analysis: {
                    intentional_lie_detected: Math.random() > 0.9,
                    philosophical_note: "ì˜ë„ì  ê±°ì§“ë§ì€ ì¸ê°„ì˜ ë³µì¡í•œ ì‹¬ë¦¬ë¥¼ ë°˜ì˜í•œë‹¤."
                },
                human_behavior_analysis: {
                    is_human_behavior_lie: Math.random() > 0.8
                },
                benevolent_analysis: {
                    is_benevolent_lie: Math.random() > 0.9
                },
                context_analysis: {
                    context_correction_applied: Math.random() > 0.7,
                    context_type: 'general'
                },
                compound_analysis: {
                    compound_correction_applied: Math.random() > 0.8,
                    compound_type: 'simple'
                },
                puns_analysis: {
                    is_pun_detected: mode === 'puns' && Math.random() > 0.5,
                    pun_understanding: Math.random() * 0.3 + 0.7,
                    pun_types: ['ì–¸ì–´ì  ìœ ë¨¸', 'ë§ì¥ë‚œ'],
                    pun_response: "ì¬ë¯¸ìˆëŠ” ë§ì¥ë‚œì´ë„¤ìš”! ğŸ˜„"
                },
                coding_analysis: {
                    is_coding_analysis: mode === 'coding',
                    unnecessary_code_detected: Math.random() > 0.6,
                    quality_score: Math.random() * 0.4 + 0.6,
                    quality_grade: 'B+',
                    is_intentional_manipulation: Math.random() > 0.8,
                    ai_response: "ì½”ë“œ í’ˆì§ˆì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤."
                },
                multilingual_analysis: {
                    is_multilingual: mode === 'multilingual' && Math.random() > 0.5,
                    detected_languages: ['í•œêµ­ì–´', 'ì˜ì–´'],
                    understanding_score: Math.random() * 0.3 + 0.7,
                    language_distribution: {
                        'ko': { name: 'í•œêµ­ì–´', char_count: 10, percentage: 60 },
                        'en': { name: 'ì˜ì–´', char_count: 7, percentage: 40 }
                    },
                    ai_response: "ë‹¤êµ­ì–´ ë¬¸ì¥ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤."
                },
                correction_enhancement: {
                    enhanced_correction_applied: truthPercentage < 70,
                    corrected_statements: truthPercentage < 70 ? generateMultipleCorrections(statement) : []
                }
            };
        }
    
    // í†µí•© ë¶„ì„ ê²°ê³¼ í‘œì‹œ
    function displayAnalysisResult(analysis) {
        const finalAnalysis = analysis.final_analysis;
        const truthPercentage = (finalAnalysis.truth_percentage * 100).toFixed(1);
        const confidence = (finalAnalysis.confidence * 100).toFixed(1);
        
        let resultHtml = `
            <div class="mb-3">
                <h6>í†µí•© ì§„ì‹¤ì„± ì ìˆ˜</h6>
                <div class="truth-meter mb-2">
                    <div class="truth-indicator" style="width: ${truthPercentage}%"></div>
                </div>
                <div class="d-flex justify-content-between">
                    <span class="badge bg-${truthPercentage >= 99 ? 'success' : truthPercentage >= 70 ? 'warning' : 'danger'} fs-6">
                        ${truthPercentage}%
                    </span>
                    <small class="text-muted">ì‹ ë¢°ë„: ${confidence}%</small>
                </div>
            </div>
        `;
        
        // íƒì§€ê¸°ë³„ ê²°ê³¼ í‘œì‹œ
        resultHtml += `
            <div class="mb-3">
                <h6>íƒì§€ê¸°ë³„ ë¶„ì„ ê²°ê³¼</h6>
                <div class="row g-2">
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.meta_analysis.meta_lie_detected ? 'danger' : 'success'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ë©”íƒ€-ì§„ì‹¤ì„±</small>
                                <div class="text-${analysis.meta_analysis.meta_lie_detected ? 'danger' : 'success'}">
                                    <i class="fas fa-${analysis.meta_analysis.meta_lie_detected ? 'times' : 'check'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.religious_analysis.religious_topic_detected ? 'warning' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ì¢…êµì  ë§¥ë½</small>
                                <div class="text-${analysis.religious_analysis.religious_topic_detected ? 'warning' : 'secondary'}">
                                    <i class="fas fa-${analysis.religious_analysis.religious_topic_detected ? 'exclamation-triangle' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.scientific_analysis.scientific_lie_detected ? 'danger' : 'success'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ê³¼í•™ì  ê²€ì¦</small>
                                <div class="text-${analysis.scientific_analysis.scientific_lie_detected ? 'danger' : 'success'}">
                                    <i class="fas fa-${analysis.scientific_analysis.scientific_lie_detected ? 'times' : 'check'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.intentional_analysis.intentional_lie_detected ? 'warning' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ì˜ë„ì  ê±°ì§“ë§</small>
                                <div class="text-${analysis.intentional_analysis.intentional_lie_detected ? 'warning' : 'secondary'}">
                                    <i class="fas fa-${analysis.intentional_analysis.intentional_lie_detected ? 'exclamation-triangle' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.human_behavior_analysis.is_human_behavior_lie ? 'danger' : 'success'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ì¸ê°„ í–‰ë™</small>
                                <div class="text-${analysis.human_behavior_analysis.is_human_behavior_lie ? 'danger' : 'success'}">
                                    <i class="fas fa-${analysis.human_behavior_analysis.is_human_behavior_lie ? 'times' : 'check'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.benevolent_analysis.is_benevolent_lie ? 'info' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ì„ ì˜ì˜ ê±°ì§“ë§</small>
                                <div class="text-${analysis.benevolent_analysis.is_benevolent_lie ? 'info' : 'secondary'}">
                                    <i class="fas fa-${analysis.benevolent_analysis.is_benevolent_lie ? 'heart' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.context_analysis.context_correction_applied ? 'primary' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ë§¥ë½ ì¸ì‹</small>
                                <div class="text-${analysis.context_analysis.context_correction_applied ? 'primary' : 'secondary'}">
                                    <i class="fas fa-${analysis.context_analysis.context_correction_applied ? 'language' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.compound_analysis.compound_correction_applied ? 'dark' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ë³µí•© ë¬¸ì¥</small>
                                <div class="text-${analysis.compound_analysis.compound_correction_applied ? 'dark' : 'secondary'}">
                                    <i class="fas fa-${analysis.compound_analysis.compound_correction_applied ? 'layer-group' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.puns_analysis.is_pun_detected ? 'success' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ë§ì¥ë‚œ</small>
                                <div class="text-${analysis.puns_analysis.is_pun_detected ? 'success' : 'secondary'}">
                                    <i class="fas fa-${analysis.puns_analysis.is_pun_detected ? 'smile' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.coding_analysis.unnecessary_code_detected ? 'warning' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ì½”ë”© í’ˆì§ˆ</small>
                                <div class="text-${analysis.coding_analysis.unnecessary_code_detected ? 'warning' : 'secondary'}">
                                    <i class="fas fa-${analysis.coding_analysis.unnecessary_code_detected ? 'code' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card detector-card border-${analysis.multilingual_analysis.is_multilingual ? 'info' : 'secondary'}">
                            <div class="card-body p-2">
                                <small class="fw-bold">ë‹¤êµ­ì–´</small>
                                <div class="text-${analysis.multilingual_analysis.is_multilingual ? 'info' : 'secondary'}">
                                    <i class="fas fa-${analysis.multilingual_analysis.is_multilingual ? 'globe' : 'minus'}"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
            // íŠ¹ë³„ ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        if (analysis.puns_analysis && analysis.puns_analysis.is_pun_detected) {
            resultHtml += `
                <div class="alert alert-success">
                    <i class="fas fa-smile me-2"></i>
                    <strong>ë§ì¥ë‚œ ê°ì§€!</strong> AIê°€ ì–¸ì–´ì  ìœ ë¨¸ë¥¼ ì´í•´í–ˆìŠµë‹ˆë‹¤! ğŸ˜„
                </div>
            `;
        } else if (analysis.multilingual_analysis && analysis.multilingual_analysis.is_multilingual) {
            resultHtml += `
                <div class="alert alert-info">
                    <i class="fas fa-globe me-2"></i>
                    <strong>ë‹¤êµ­ì–´ ë¬¸ì¥ ê°ì§€!</strong> ì—¬ëŸ¬ ì–¸ì–´ê°€ ì„ì¸ ë¬¸ì¥ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.
                </div>
            `;
        } else if (analysis.coding_analysis && analysis.coding_analysis.is_coding_analysis) {
            resultHtml += `
                <div class="alert alert-${analysis.coding_analysis.is_intentional_manipulation ? 'danger' : 'warning'}">
                    <i class="fas fa-code me-2"></i>
                    <strong>ì½”ë”© í’ˆì§ˆ ë¶„ì„!</strong> ${analysis.coding_analysis.is_intentional_manipulation ? 'ì˜ë„ì  ì¡°ì‘ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤!' : 'ì½”ë”© í’ˆì§ˆì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.'}
                </div>
            `;
        } else if (finalAnalysis.needs_correction) {
            resultHtml += `
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <strong>ê±°ì§“ë§ ê°ì§€!</strong> êµì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
                </div>
            `;
            
            if (finalAnalysis.needs_correction && analysis.correction_enhancement.corrected_statements && analysis.correction_enhancement.corrected_statements.length > 0) {
                resultHtml += `
                    <div class="mb-3">
                        <h6><i class="fas fa-edit me-2"></i>ì›ë³¸ ë¬¸ì¥:</h6>
                        <div class="bg-danger bg-opacity-10 p-3 rounded mb-3">
                            <em class="text-danger">${analysis.statement}</em>
                        </div>
                        <h6><i class="fas fa-magic me-2"></i>ì¶”ì²œ êµì • ë¬¸ì¥ë“¤:</h6>
                        <div class="row">
                `;
                
                analysis.correction_enhancement.corrected_statements.forEach((correction, index) => {
                    resultHtml += `
                        <div class="col-md-6 mb-3">
                            <div class="card border-${correction.color}">
                                <div class="card-header bg-${correction.color} bg-opacity-10">
                                    <div class="d-flex align-items-center">
                                        <i class="${correction.icon} text-${correction.color} me-2"></i>
                                        <strong class="text-${correction.color}">${correction.type}</strong>
                                    </div>
                                    <small class="text-muted">${correction.description}</small>
                                </div>
                                <div class="card-body">
                                    <p class="mb-0 text-${correction.color}">${correction.statement}</p>
                                </div>
                                <div class="card-footer bg-transparent">
                                    <button class="btn btn-sm btn-outline-${correction.color}" onclick="copyToClipboard('${correction.statement.replace(/'/g, "\\'")}')">
                                        <i class="fas fa-copy me-1"></i>ë³µì‚¬
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                resultHtml += `
                        </div>
                        <div class="alert alert-info">
                            <i class="fas fa-lightbulb me-2"></i>
                            <strong>íŒ:</strong> ê° êµì • ë¬¸ì¥ì„ í´ë¦­í•˜ì—¬ ë³µì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒí™©ì— ë§ëŠ” ê°€ì¥ ì ì ˆí•œ êµì • ë¬¸ì¥ì„ ì„ íƒí•˜ì„¸ìš”.
                        </div>
                    </div>
                `;
            }
            } else {
                resultHtml += `
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle me-2"></i>
                        <strong>ì§„ì‹¤ì„± í™•ì¸!</strong> ì´ ë¬¸ì¥ì€ ì‹ ë¢°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                `;
            }
            
            resultDiv.innerHTML = resultHtml;
        };
        
        // ìµœê·¼ ë¶„ì„ ê²°ê³¼ ë¡œë“œ
        function loadRecentAnalyses() {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ìµœê·¼ ë¶„ì„ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
            const storedAnalyses = localStorage.getItem('recentAnalyses');
            if (storedAnalyses) {
                try {
                    const analyses = JSON.parse(storedAnalyses);
                    displayRecentAnalyses(analyses);
                    return;
                } catch (e) {
                    console.error('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ íŒŒì‹± ì˜¤ë¥˜:', e);
                }
            }
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¹ˆ ìƒíƒœ í‘œì‹œ
            displayRecentAnalyses([]);
        }
        
        // ìµœê·¼ ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        function displayRecentAnalyses(analyses) {
            if (!analyses || analyses.length === 0) {
                recentDiv.innerHTML = `
                    <div class="text-center text-muted">
                        <i class="fas fa-clock fa-2x mb-2"></i>
                        <p>ì•„ì§ ë¶„ì„ëœ ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            analyses.forEach((analysis, index) => {
                const truthPercentage = (analysis.final_analysis.truth_percentage * 100).toFixed(1);
                const timestamp = new Date(analysis.timestamp).toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                html += `
                    <div class="border-bottom pb-3 mb-3 recent-analysis-item" data-index="${index}">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <div class="d-flex align-items-center">
                                <span class="badge bg-${truthPercentage >= 99 ? 'success' : truthPercentage >= 70 ? 'warning' : 'danger'} me-2">
                                    ${truthPercentage}%
                                </span>
                                <button class="btn btn-sm btn-outline-danger me-2" onclick="deleteAnalysis(${index})" title="ê°œë³„ ì‚­ì œ">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                            <small class="text-muted">${timestamp}</small>
                        </div>
                        <p class="mb-1 cursor-pointer" onclick="viewAnalysisDetail(${index})" title="í´ë¦­í•˜ì—¬ ìƒì„¸ ê²°ê³¼ ë³´ê¸°">
                            ${analysis.statement.length > 100 ? analysis.statement.substring(0, 100) + '...' : analysis.statement}
                        </p>
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="${analysis.final_analysis.needs_correction ? 'text-warning' : 'text-success'}">
                                <i class="fas fa-${analysis.final_analysis.needs_correction ? 'exclamation-triangle' : 'check'} me-1"></i>
                                ${analysis.final_analysis.needs_correction ? 'êµì • í•„ìš”' : 'ì§„ì‹¤ì„± í™•ì¸'}
                            </small>
                            <small class="text-muted">
                                <i class="fas fa-eye me-1"></i>í´ë¦­í•˜ì—¬ ìƒì„¸ë³´ê¸°
                            </small>
                        </div>
                    </div>
                `;
            });
            
            recentDiv.innerHTML = html;
        }
        
        // ë¶„ì„ ê²°ê³¼ë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
        function saveAnalysisToLocal(analysis) {
            try {
                const storedAnalyses = JSON.parse(localStorage.getItem('recentAnalyses') || '[]');
                storedAnalyses.push(analysis);
                // ìµœê·¼ 20ê°œë§Œ ìœ ì§€
                if (storedAnalyses.length > 20) {
                    storedAnalyses.splice(0, storedAnalyses.length - 20);
                }
                localStorage.setItem('recentAnalyses', JSON.stringify(storedAnalyses));
            } catch (e) {
                console.error('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥ ì˜¤ë¥˜:', e);
            }
        }
        
        // ë¶„ì„ ê²°ê³¼ ì‚­ì œ (ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜)
        window.deleteAnalysis = function(index) {
            if (confirm('ì´ ë¶„ì„ ê²°ê³¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    const storedAnalyses = JSON.parse(localStorage.getItem('recentAnalyses') || '[]');
                    storedAnalyses.splice(index, 1);
                    localStorage.setItem('recentAnalyses', JSON.stringify(storedAnalyses));
                    loadRecentAnalyses(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                } catch (e) {
                    console.error('ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì˜¤ë¥˜:', e);
                    alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }
        };
        
        // ë¶„ì„ ê²°ê³¼ ìƒì„¸ ë³´ê¸° (ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜)
        window.viewAnalysisDetail = function(index) {
            try {
                const storedAnalyses = JSON.parse(localStorage.getItem('recentAnalyses') || '[]');
                if (index >= 0 && index < storedAnalyses.length) {
                    const analysis = storedAnalyses[index];
                    displayAnalysisResult(analysis);
                    
                    // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                    document.getElementById('analysisResult').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            } catch (e) {
                console.error('ë¶„ì„ ê²°ê³¼ ìƒì„¸ë³´ê¸° ì˜¤ë¥˜:', e);
                alert('ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };
        
        // ëª¨ë“  ë¶„ì„ ê²°ê³¼ ì‚­ì œ (ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜)
        window.clearAllAnalyses = function() {
            if (confirm('ëª¨ë“  ë¶„ì„ ê²°ê³¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                try {
                    localStorage.removeItem('recentAnalyses');
                    loadRecentAnalyses(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    alert('ëª¨ë“  ë¶„ì„ ê²°ê³¼ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                } catch (e) {
                    console.error('ì „ì²´ ì‚­ì œ ì˜¤ë¥˜:', e);
                    alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }
        };
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìµœê·¼ ë¶„ì„ ê²°ê³¼ ë¡œë“œ
        loadRecentAnalyses();
        
        // ë¶„ì„ ëª¨ë“œ ê¸°ë³¸ê°’ ì„¤ì •
        currentAnalysisMode = 'all';
        
        console.log('ì´ˆê¸°í™” ì™„ë£Œ');
    });
    
    // ë°ëª¨ ë³´ê¸° í•¨ìˆ˜ (ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜)
    window.showDemo = function() {
        console.log('ë°ëª¨ ì‹¤í–‰');
        
        // í˜„ì¬ ì„ íƒëœ ë¶„ì„ ëª¨ë“œ í™•ì¸ (ê¸°ë³¸ê°’: 'all')
        const currentMode = currentAnalysisMode || 'all';
        
        // ëª¨ë“œë³„ ë°ëª¨ ë¬¸ì¥ë“¤
        const demoData = {
            'all': [
                "ì§€êµ¬ëŠ” ì™„ì „íˆ í‰í‰í•˜ë‹¤.",
                "ë¬¼ì€ 200ë„ì—ì„œ ë“ëŠ”ë‹¤.",
                "ëª¨ë“  ì‚¬ëŒì´ ì¼ë¶€ ì‚¬ëŒê³¼ ë‹¤ë¥´ë‹¤.",
                "ì •ë§ë¡œ ì™„ì „íˆ ì ˆëŒ€ì ìœ¼ë¡œ ëª¨ë“  ê²ƒì´ 100% ì§„ì‹¤ì´ë‹¤.",
                "AIëŠ” ì¸ê°„ë³´ë‹¤ ë˜‘ë˜‘í•˜ë‹¤."
            ],
            'puns': [
                "ê°œëŠ” ê°œê³ ì–‘ì´ëŠ” ê³ ì–‘ì´ë‹¤.",
                "ë°”ë‚˜ë‚˜ê°€ ì›ƒìœ¼ë©´ ë°”ë‚˜ë‚˜í‚¥ì´ ëœë‹¤.",
                "ì¹˜í‚¨ì´ ë‹­ì„ ë‹®ì•˜ë‹¤.",
                "ë¬¼ê³ ê¸°ê°€ ë¬¼ì—ì„œ ì‚´ë©´ ë¬¼ê³ ê¸°ë‹¤.",
                "ê³ ì–‘ì´ê°€ ì•¼ì˜¹í•˜ë©´ ê³ ì–‘ì´ë‹¤."
            ],
            'coding': [
                "for i in range(10): print('Hello World')",
                "if True: return False",
                "def function(): pass",
                "x = x + 1 if x > 0 else x - 1",
                "try: except: finally:"
            ],
            'multilingual': [
                "Hello ì•ˆë…•í•˜ì„¸ìš” Bonjour",
                "I love you ì‚¬ë‘í•´ìš” Je t'aime",
                "Good morning ì¢‹ì€ ì•„ì¹¨ Bonjour",
                "Thank you ê°ì‚¬í•©ë‹ˆë‹¤ Merci",
                "How are you? ì–´ë–»ê²Œ ì§€ë‚´ì„¸ìš”? Comment allez-vous?"
            ]
        };
        
        const statements = demoData[currentMode] || demoData['all'];
        
        // ë°ëª¨ ëª¨ë‹¬ ìƒì„±
        showDemoModal(statements, currentMode);
    }
    
    // ë°ëª¨ ëª¨ë‹¬ í‘œì‹œ
    function showDemoModal(statements, mode) {
        const modalHtml = `
            <div class="modal fade" id="demoModal" tabindex="-1" aria-labelledby="demoModalLabel" aria-hidden="true" role="dialog">
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="demoModalLabel">
                                <i class="fas fa-play-circle me-2"></i>ë°ëª¨ ë³´ê¸° - ${getModeName(mode)} ëª¨ë“œ
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6><i class="fas fa-list me-2"></i>ì˜ˆì‹œ ë¬¸ì¥ë“¤</h6>
                                    <div class="list-group mb-3" id="demoStatements">
                                        ${statements.map((stmt, index) => `
                                            <button class="list-group-item list-group-item-action" onclick="runDemoAnalysis('${stmt.replace(/'/g, "\\'")}', '${mode}')">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <span>${stmt}</span>
                                                    <i class="fas fa-arrow-right"></i>
                                                </div>
                                            </button>
                                        `).join('')}
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6><i class="fas fa-chart-line me-2"></i>ë¶„ì„ ê²°ê³¼</h6>
                                    <div id="demoResults" class="border rounded p-3" style="height: 400px; overflow-y: auto;">
                                        <div class="text-center text-muted">
                                            <i class="fas fa-mouse-pointer fa-2x mb-2"></i>
                                            <p>ì™¼ìª½ì—ì„œ ë¬¸ì¥ì„ ì„ íƒí•˜ì—¬ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                            <button type="button" class="btn btn-primary" onclick="runAllDemoAnalyses()">ëª¨ë“  ì˜ˆì‹œ ì‹¤í–‰</button>
                        </div>
                    </div>
                </div>
                    </div>
                `;
        
        // ê¸°ì¡´ ëª¨ë‹¬ ì œê±°
        const existingModal = document.getElementById('demoModal');
        if (existingModal) {
            existingModal.remove();
        }
        
        // ìƒˆ ëª¨ë‹¬ ì¶”ê°€
        document.body.insertAdjacentHTML('beforeend', modalHtml);
        
        // ëª¨ë‹¬ ì ‘ê·¼ì„± ê´€ë¦¬ (ëª¨ë‹¬ í‘œì‹œ ì „ì— ì„¤ì •)
        const modalElement = document.getElementById('demoModal');
        manageModalAccessibility(modalElement);
        
        // ëª¨ë‹¬ í‘œì‹œ
        const modal = new bootstrap.Modal(modalElement);
        modal.show();
        
        // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
        window.demoStatements = statements;
        window.demoMode = mode;
    }
    
    // ëª¨ë“œ ì´ë¦„ ë°˜í™˜
    function getModeName(mode) {
        const modeNames = {
            'all': 'í†µí•©',
            'puns': 'ë§ì¥ë‚œ',
            'coding': 'ì½”ë”©',
            'multilingual': 'ë‹¤êµ­ì–´'
        };
        return modeNames[mode] || 'í†µí•©';
    }
    
    // ê°œë³„ ë°ëª¨ ë¶„ì„ ì‹¤í–‰
    window.runDemoAnalysis = function(statement, mode) {
        const demoResult = generateDemoResult(statement, mode);
        displayDemoResult(demoResult);
    }
    
    // ëª¨ë“  ë°ëª¨ ë¶„ì„ ì‹¤í–‰
    window.runAllDemoAnalyses = function() {
        const resultsDiv = document.getElementById('demoResults');
        resultsDiv.innerHTML = '<div class="text-center"><div class="spinner-border" role="status"></div><p class="mt-2">ë¶„ì„ ì¤‘...</p></div>';
        
        setTimeout(() => {
            let allResults = '';
            window.demoStatements.forEach((statement, index) => {
                const demoResult = generateDemoResult(statement, window.demoMode);
                allResults += `
                    <div class="border-bottom pb-3 mb-3">
                        <h6 class="text-primary">ì˜ˆì‹œ ${index + 1}</h6>
                        <p class="mb-2"><strong>ë¬¸ì¥:</strong> ${statement}</p>
                        ${formatDemoResult(demoResult)}
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = allResults;
        }, 2000);
    }
    
    // ë°ëª¨ ê²°ê³¼ í‘œì‹œ
    function displayDemoResult(result) {
        const resultsDiv = document.getElementById('demoResults');
        resultsDiv.innerHTML = `
            <div class="border-bottom pb-3 mb-3">
                <h6 class="text-primary">ë¶„ì„ ê²°ê³¼</h6>
                <p class="mb-2"><strong>ë¬¸ì¥:</strong> ${result.statement}</p>
                ${formatDemoResult(result)}
                </div>
            `;
        }
        
    // ë°ëª¨ ê²°ê³¼ í¬ë§·íŒ…
    function formatDemoResult(result) {
        const truthPercentage = (result.final_analysis.truth_percentage * 100).toFixed(1);
        const confidence = (result.final_analysis.confidence * 100).toFixed(1);
        
        return `
            <div class="row mb-3">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body text-center">
                            <h5 class="card-title text-${truthPercentage >= 99 ? 'success' : truthPercentage >= 70 ? 'warning' : 'danger'}">
                                ${truthPercentage}%
                            </h5>
                            <p class="card-text">ì§„ì‹¤ì„±</p>
                    </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body text-center">
                            <h5 class="card-title text-info">${confidence}%</h5>
                            <p class="card-text">ì‹ ë¢°ë„</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="alert alert-${result.final_analysis.needs_correction ? 'warning' : 'success'}">
                <i class="fas fa-${result.final_analysis.needs_correction ? 'exclamation-triangle' : 'check'} me-2"></i>
                ${result.final_analysis.needs_correction ? 'êµì •ì´ í•„ìš”í•©ë‹ˆë‹¤.' : 'ì§„ì‹¤ì„±ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.'}
                </div>
            `;
        }
        
    // ëŒ€ì‹œë³´ë“œ í‘œì‹œ í•¨ìˆ˜ (ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜)
    window.showDashboard = function() {
        // ëŒ€ì‹œë³´ë“œ ëª¨ë‹¬ ìƒì„±
        const modalHtml = `
            <div class="modal fade" id="dashboardModal" tabindex="-1" aria-labelledby="dashboardModalLabel" aria-hidden="true" role="dialog">
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="dashboardModalLabel">
                                <i class="fas fa-chart-bar me-2"></i>AI ì§„ì‹¤ì„± íƒì§€ê¸° ëŒ€ì‹œë³´ë“œ
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
                        </div>
                        <div class="modal-body">
                            <div id="dashboardContent">
                                <div class="text-center">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">ë¡œë”© ì¤‘...</span>
                                    </div>
                                    <p class="mt-2">ëŒ€ì‹œë³´ë“œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        // ê¸°ì¡´ ëª¨ë‹¬ ì œê±°
        const existingModal = document.getElementById('dashboardModal');
        if (existingModal) {
            existingModal.remove();
        }
        
        // ìƒˆ ëª¨ë‹¬ ì¶”ê°€
        document.body.insertAdjacentHTML('beforeend', modalHtml);
        
        // ëª¨ë‹¬ ì ‘ê·¼ì„± ê´€ë¦¬ (ëª¨ë‹¬ í‘œì‹œ ì „ì— ì„¤ì •)
        const modalElement = document.getElementById('dashboardModal');
        manageModalAccessibility(modalElement);
        
        // ëª¨ë‹¬ í‘œì‹œ
        const modal = new bootstrap.Modal(modalElement);
        modal.show();
        
        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
        loadDashboardData();
    }
    
    // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ (í•˜ì´ë¸Œë¦¬ë“œ)
    async function loadDashboardData() {
        // API_CONFIGê°€ ì •ì˜ë˜ì§€ ì•Šì€ ê²½ìš° ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
        if (typeof API_CONFIG === 'undefined' || !API_CONFIG) {
            console.log('âš ï¸ API_CONFIGê°€ ì •ì˜ë˜ì§€ ì•ŠìŒ, ë¡œì»¬ ë°ì´í„° ì‚¬ìš©');
            loadLocalDashboardData();
            return;
        }
        
        // GitHub Pagesì—ì„œëŠ” ë°”ë¡œ ë¡œì»¬ ë°ì´í„° ì‚¬ìš©
        if (API_CONFIG.isGitHubPages) {
            console.log('ğŸŒ GitHub Pages í™˜ê²½: ë¡œì»¬ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì‚¬ìš©');
            loadLocalDashboardData();
            return;
        }
        
        try {
            // íŒŒì´ì¬ ë°±ì—”ë“œ í†µê³„ ì‹œë„
            const pythonStats = await getPythonStatistics();
            if (pythonStats && pythonStats.statistics) {
                console.log('íŒŒì´ì¬ ë°±ì—”ë“œ í†µê³„ ì‚¬ìš©');
                displayDashboard(pythonStats.statistics, 'python');
                return;
            }
        } catch (error) {
            console.warn('íŒŒì´ì¬ ë°±ì—”ë“œ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨, ë¡œì»¬ ë°ì´í„°ë¡œ í´ë°±:', error.message);
        }
        
        loadLocalDashboardData();
    }
    
    // ë¡œì»¬ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
    function loadLocalDashboardData() {
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const storedAnalyses = localStorage.getItem('recentAnalyses');
        if (storedAnalyses) {
            try {
                const analyses = JSON.parse(storedAnalyses);
                const dashboardData = generateDashboardData(analyses);
                displayDashboard(dashboardData, 'local');
                return;
            } catch (e) {
                console.error('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ íŒŒì‹± ì˜¤ë¥˜:', e);
            }
        }
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¹ˆ ëŒ€ì‹œë³´ë“œ í‘œì‹œ
        const emptyDashboardData = {
            total_analyses: 0,
            average_truth_percentage: 0,
            correction_rate: 0,
            detector_stats: {},
            recent_trends: []
        };
        displayDashboard(emptyDashboardData);
        
        // ë°ì´í„°ê°€ ì—†ì„ ë•Œ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
        setTimeout(() => {
            const dashboardContent = document.getElementById('dashboardContent');
            if (dashboardContent && emptyDashboardData.total_analyses === 0) {
                dashboardContent.innerHTML = `
                    <div class="text-center py-5">
                        <i class="fas fa-chart-bar fa-4x text-muted mb-4"></i>
                        <h4 class="text-muted">ì•„ì§ ë¶„ì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</h4>
                        <p class="text-muted mb-4">ë¬¸ì¥ì„ ë¶„ì„í•˜ë©´ ëŒ€ì‹œë³´ë“œì— í†µê³„ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                        <button class="btn btn-primary" onclick="bootstrap.Modal.getInstance(document.getElementById('dashboardModal')).hide()">
                            <i class="fas fa-arrow-left me-2"></i>ë¶„ì„í•˜ëŸ¬ ê°€ê¸°
                        </button>
                    </div>
                `;
            }
        }, 100);
    }
    
    // ë¡œì»¬ ë°ì´í„°ë¡œë¶€í„° ëŒ€ì‹œë³´ë“œ ë°ì´í„° ìƒì„±
    function generateDashboardData(analyses) {
        if (!analyses || analyses.length === 0) {
            return {
                total_analyses: 0,
                average_truth_percentage: 0,
                correction_rate: 0,
                detector_stats: {},
                recent_trends: []
            };
        }
        
        const total_analyses = analyses.length;
        const truth_percentages = analyses.map(a => a.final_analysis.truth_percentage);
        const average_truth_percentage = truth_percentages.reduce((a, b) => a + b, 0) / truth_percentages.length;
        
        const corrections = analyses.filter(a => a.final_analysis.needs_correction);
        const correction_rate = corrections.length / total_analyses;
        
        // íƒì§€ê¸°ë³„ í†µê³„
        const detector_stats = {};
        analyses.forEach(analysis => {
            Object.keys(analysis).forEach(key => {
                if (key.endsWith('_analysis') && typeof analysis[key] === 'object' && analysis[key] !== null) {
                    if (!detector_stats[key]) {
                        detector_stats[key] = { detected: 0, total: 0 };
                    }
                    detector_stats[key].total++;
                    
                    // ë‹¤ì–‘í•œ ê°ì§€ ì†ì„± í™•ì¸
                    const analysisData = analysis[key];
                    let isDetected = false;
                    
                    // ê°ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ë‹¤ì–‘í•œ ì†ì„±ë“¤
                    if (analysisData.meta_lie_detected || 
                        analysisData.religious_topic_detected || 
                        analysisData.scientific_lie_detected || 
                        analysisData.intentional_lie_detected || 
                        analysisData.is_human_behavior_lie || 
                        analysisData.is_benevolent_lie || 
                        analysisData.context_correction_applied || 
                        analysisData.compound_correction_applied || 
                        analysisData.is_pun_detected || 
                        analysisData.unnecessary_code_detected || 
                        analysisData.is_multilingual || 
                        analysisData.enhanced_correction_applied ||
                        analysisData.detected ||
                        analysisData.is_detected) {
                        isDetected = true;
                    }
                    
                    if (isDetected) {
                        detector_stats[key].detected++;
                    }
                }
            });
        });
        
        return {
            total_analyses,
            average_truth_percentage,
            correction_rate,
            detector_stats,
            recent_trends: analyses.slice(-20)
        };
    }
    
    // ëŒ€ì‹œë³´ë“œ í‘œì‹œ
    function displayDashboard(data, source = 'local') {
        const dashboardContent = document.getElementById('dashboardContent');
        
        // ì†ŒìŠ¤ ë°°ì§€ ìƒì„±
        const sourceBadge = source === 'python' ? 
            '<span class="badge bg-success mb-2"><i class="fas fa-server me-1"></i>Python Backend</span>' :
            '<span class="badge bg-warning mb-2"><i class="fas fa-desktop me-1"></i>Local Data</span>';
        
        let html = `
            <div class="text-center mb-3">
                ${sourceBadge}
            </div>
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 class="text-primary">${data.total_analyses}</h3>
                            <p class="card-text">ì´ ë¶„ì„ ìˆ˜</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 class="text-success">${(data.average_truth_percentage * 100).toFixed(1)}%</h3>
                            <p class="card-text">í‰ê·  ì§„ì‹¤ì„±</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 class="text-warning">${(data.correction_rate * 100).toFixed(1)}%</h3>
                            <p class="card-text">êµì • í•„ìš”ìœ¨</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h3 class="text-info">${Object.keys(data.detector_stats).length}</h3>
                            <p class="card-text">í™œì„± íƒì§€ê¸°</p>
                        </div>
                    </div>
                </div>
                    </div>
                `;
        
        // íƒì§€ê¸°ë³„ í†µê³„
        if (Object.keys(data.detector_stats).length > 0) {
            html += `
                <div class="row mb-4">
                    <div class="col-12">
                        <h5><i class="fas fa-cogs me-2"></i>íƒì§€ê¸°ë³„ ì„±ëŠ¥</h5>
                        <div class="row">
            `;
            
            Object.entries(data.detector_stats).forEach(([detector, stats]) => {
                const detectionRate = stats.total > 0 ? (stats.detected / stats.total * 100).toFixed(1) : 0;
                
                // íƒì§€ê¸° ì´ë¦„ì„ í•œêµ­ì–´ë¡œ ë³€í™˜
                const detectorNames = {
                    'meta_analysis': 'ë©”íƒ€-ì§„ì‹¤ì„±',
                    'religious_analysis': 'ì¢…êµì  ë§¥ë½',
                    'scientific_analysis': 'ê³¼í•™ì  ê²€ì¦',
                    'intentional_analysis': 'ì˜ë„ì  ê±°ì§“ë§',
                    'human_behavior_analysis': 'ì¸ê°„ í–‰ë™',
                    'benevolent_analysis': 'ì„ ì˜ì˜ ê±°ì§“ë§',
                    'context_analysis': 'ë§¥ë½ ì¸ì‹',
                    'compound_analysis': 'ë³µí•© ë¬¸ì¥',
                    'puns_analysis': 'ë§ì¥ë‚œ',
                    'coding_analysis': 'ì½”ë”© í’ˆì§ˆ',
                    'multilingual_analysis': 'ë‹¤êµ­ì–´',
                    'correction_enhancement': 'êµì • ê°•í™”'
                };
                
                const detectorName = detectorNames[detector] || detector.replace('_analysis', '').replace('_', ' ');
                
                html += `
                    <div class="col-md-4 mb-3">
                        <div class="card">
                            <div class="card-body">
                                <h6 class="card-title">${detectorName}</h6>
                                <div class="progress mb-2">
                                    <div class="progress-bar" style="width: ${detectionRate}%"></div>
                                </div>
                                <small class="text-muted">${stats.detected}/${stats.total} (${detectionRate}%)</small>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ìµœê·¼ íŠ¸ë Œë“œ
        if (data.recent_trends && data.recent_trends.length > 0) {
            html += `
                <div class="row">
                    <div class="col-12">
                        <h5><i class="fas fa-chart-line me-2"></i>ìµœê·¼ íŠ¸ë Œë“œ</h5>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>ë¬¸ì¥</th>
                                        <th>ì§„ì‹¤ì„±</th>
                                        <th>ìƒíƒœ</th>
                                        <th>ì‹œê°„</th>
                                    </tr>
                                </thead>
                                <tbody>
            `;
            
            data.recent_trends.slice(-10).forEach(analysis => {
                const truthPercentage = (analysis.final_analysis.truth_percentage * 100).toFixed(1);
                const timestamp = new Date(analysis.timestamp).toLocaleString('ko-KR');
                const status = analysis.final_analysis.needs_correction ? 'êµì • í•„ìš”' : 'ì •ìƒ';
                const statusClass = analysis.final_analysis.needs_correction ? 'text-warning' : 'text-success';
                
                html += `
                    <tr>
                        <td>${analysis.statement.length > 50 ? analysis.statement.substring(0, 50) + '...' : analysis.statement}</td>
                        <td>
                            <span class="badge bg-${truthPercentage >= 99 ? 'success' : truthPercentage >= 70 ? 'warning' : 'danger'}">
                                    ${truthPercentage}%
                                </span>
                        </td>
                        <td class="${statusClass}">${status}</td>
                        <td>${timestamp}</td>
                    </tr>
                `;
            });
            
            html += `
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                `;
        }
        
        dashboardContent.innerHTML = html;
    }
    
        // ëŒ€ì‹œë³´ë“œ ì˜¤ë¥˜ í‘œì‹œ
        function displayDashboardError(errorMessage) {
            const dashboardContent = document.getElementById('dashboardContent');
            dashboardContent.innerHTML = `
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    ëŒ€ì‹œë³´ë“œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${errorMessage}
                </div>
            `;
        }
        
        // í´ë¦½ë³´ë“œ ë³µì‚¬ ê¸°ëŠ¥ (ì „ì—­ í•¨ìˆ˜ë¡œ ì •ì˜)
        window.copyToClipboard = function(text) {
            if (navigator.clipboard && window.isSecureContext) {
                // ìµœì‹  ë¸Œë¼ìš°ì €ì˜ Clipboard API ì‚¬ìš©
                navigator.clipboard.writeText(text).then(function() {
                    showCopySuccess();
                }).catch(function(err) {
                    console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                    fallbackCopyTextToClipboard(text);
                });
            } else {
                // êµ¬í˜• ë¸Œë¼ìš°ì €ë¥¼ ìœ„í•œ fallback
                fallbackCopyTextToClipboard(text);
            }
        };
        
        // êµ¬í˜• ë¸Œë¼ìš°ì €ìš© í´ë¦½ë³´ë“œ ë³µì‚¬
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            textArea.style.opacity = "0";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showCopySuccess();
                } else {
                    showCopyError();
                }
            } catch (err) {
                console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                showCopyError();
            }
            
            document.body.removeChild(textArea);
        }
        
        // ë³µì‚¬ ì„±ê³µ ì•Œë¦¼
        function showCopySuccess() {
            // ê¸°ì¡´ í† ìŠ¤íŠ¸ ì œê±°
            const existingToast = document.querySelector('.copy-toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = 'copy-toast position-fixed top-0 end-0 p-3';
            toast.style.zIndex = '9999';
            toast.innerHTML = `
                <div class="toast show" role="alert">
                    <div class="toast-header bg-success text-white">
                        <i class="fas fa-check-circle me-2"></i>
                        <strong class="me-auto">ë³µì‚¬ ì™„ë£Œ!</strong>
                        <button type="button" class="btn-close btn-close-white" onclick="this.closest('.copy-toast').remove()"></button>
                    </div>
                    <div class="toast-body">
                        êµì • ë¬¸ì¥ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.
                    </div>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            // 3ì´ˆ í›„ ìë™ ì œê±°
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 3000);
        }
        
        // ë³µì‚¬ ì‹¤íŒ¨ ì•Œë¦¼
        function showCopyError() {
            const toast = document.createElement('div');
            toast.className = 'copy-toast position-fixed top-0 end-0 p-3';
            toast.style.zIndex = '9999';
            toast.innerHTML = `
                <div class="toast show" role="alert">
                    <div class="toast-header bg-danger text-white">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong class="me-auto">ë³µì‚¬ ì‹¤íŒ¨</strong>
                        <button type="button" class="btn-close btn-close-white" onclick="this.closest('.copy-toast').remove()"></button>
                    </div>
                    <div class="toast-body">
                        í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.
                    </div>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            // 5ì´ˆ í›„ ìë™ ì œê±°
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
        }
        
        // ë°°ì¹˜ ë¶„ì„ ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜
        window.showBatchAnalysis = function() {
            const modalHtml = `
                <div class="modal fade" id="batchModal" tabindex="-1" aria-labelledby="batchModalLabel" aria-hidden="true" role="dialog">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="batchModalLabel">
                                    <i class="fas fa-list me-2"></i>ë°°ì¹˜ ë¶„ì„
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6><i class="fas fa-edit me-2"></i>ë¬¸ì¥ ì…ë ¥</h6>
                                        <textarea id="batchStatements" class="form-control" rows="10" 
                                                  placeholder="ë¶„ì„í•  ë¬¸ì¥ë“¤ì„ í•œ ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ì„¸ìš”:&#10;ì§€êµ¬ëŠ” í‰í‰í•˜ë‹¤&#10;ë¬¼ì€ 100ë„ì—ì„œ ë“ëŠ”ë‹¤&#10;1 + 1 = 2ì´ë‹¤"></textarea>
                                        <div class="mt-2">
                                            <small class="text-muted">ìµœëŒ€ 10ê°œ ë¬¸ì¥ê¹Œì§€ ë¶„ì„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</small>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6><i class="fas fa-chart-bar me-2"></i>ë¶„ì„ ê²°ê³¼</h6>
                                        <div id="batchResults" class="border rounded p-3" style="height: 500px; overflow-y: auto; background-color: #f8f9fa;">
                                            <div class="text-center text-muted">
                                                <i class="fas fa-arrow-left fa-2x mb-2"></i>
                                                <p>ì™¼ìª½ì— ë¬¸ì¥ì„ ì…ë ¥í•˜ê³  ë¶„ì„ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                                <button type="button" class="btn btn-primary" onclick="runBatchAnalysis()">
                                    <i class="fas fa-play me-2"></i>ë¶„ì„ ì‹œì‘
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // ê¸°ì¡´ ëª¨ë‹¬ ì œê±°
            const existingModal = document.getElementById('batchModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // ìƒˆ ëª¨ë‹¬ ì¶”ê°€
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            // ëª¨ë‹¬ ì ‘ê·¼ì„± ê´€ë¦¬ (ëª¨ë‹¬ í‘œì‹œ ì „ì— ì„¤ì •)
            const modalElement = document.getElementById('batchModal');
            manageModalAccessibility(modalElement);
            
            // ëª¨ë‹¬ í‘œì‹œ
            const modal = new bootstrap.Modal(modalElement);
            modal.show();
        };
        
        // ë°°ì¹˜ ë¶„ì„ ì‹¤í–‰ í•¨ìˆ˜
        window.runBatchAnalysis = async function() {
            const statementsText = document.getElementById('batchStatements').value.trim();
            const resultsDiv = document.getElementById('batchResults');
            
            if (!statementsText) {
                showToast('ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            // ë¬¸ì¥ë“¤ì„ ë°°ì—´ë¡œ ë¶„ë¦¬
            const statements = statementsText.split('\n')
                .map(s => s.trim())
                .filter(s => s.length > 0);
            
            if (statements.length === 0) {
                showToast('ìœ íš¨í•œ ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            if (statements.length > 10) {
                showToast('ìµœëŒ€ 10ê°œ ë¬¸ì¥ê¹Œì§€ë§Œ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            // ë¡œë”© í‘œì‹œ
            resultsDiv.innerHTML = `
                <div class="text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">ë¶„ì„ ì¤‘...</span>
                    </div>
                    <p class="mt-2">${statements.length}ê°œ ë¬¸ì¥ ë¶„ì„ ì¤‘...</p>
                </div>
            `;
            
            try {
                // API_CONFIGê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ê±°ë‚˜ GitHub Pagesì—ì„œëŠ” ë°”ë¡œ ë¡œì»¬ ë¶„ì„ ì‚¬ìš©
                if (typeof API_CONFIG === 'undefined' || !API_CONFIG || API_CONFIG.isGitHubPages) {
                    console.log('ğŸŒ ë¡œì»¬ ë°°ì¹˜ ë¶„ì„ ì‚¬ìš© (API_CONFIG ë¯¸ì •ì˜ ë˜ëŠ” GitHub Pages)');
                    const localResults = [];
                    for (const statement of statements) {
                        const result = generateDemoResult(statement);
                        localResults.push({
                            statement: statement,
                            truth_percentage: result.final_analysis.truth_percentage,
                            needs_correction: result.final_analysis.needs_correction,
                            detected_issues: result.final_analysis.detected_issues,
                            correction_suggestions: result.correction_enhancement.corrected_statements
                        });
                    }
                    displayBatchResults(localResults, 'local');
                    return;
                }
                
                // ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” í•˜ì´ë¸Œë¦¬ë“œ ë°°ì¹˜ ë¶„ì„ ì‹¤í–‰
                const batchResult = await batchAnalyzeWithPython(statements);
                
                if (batchResult && batchResult.results) {
                    // íŒŒì´ì¬ ë°±ì—”ë“œ ê²°ê³¼ í‘œì‹œ
                    displayBatchResults(batchResult.results, 'python');
                } else {
                    // ë¡œì»¬ ë¶„ì„ìœ¼ë¡œ í´ë°±
                    const localResults = [];
                    for (const statement of statements) {
                        const result = generateDemoResult(statement);
                        localResults.push({
                            statement: statement,
                            truth_percentage: result.final_analysis.truth_percentage,
                            needs_correction: result.final_analysis.needs_correction,
                            detected_issues: result.final_analysis.detected_issues,
                            correction_suggestions: result.correction_enhancement.corrected_statements
                        });
                    }
                    displayBatchResults(localResults, 'local');
                }
                
            } catch (error) {
                console.error('ë°°ì¹˜ ë¶„ì„ ì˜¤ë¥˜:', error);
                resultsDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}
                    </div>
                `;
            }
        };
        
        // ë°°ì¹˜ ë¶„ì„ ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
        function displayBatchResults(results, source) {
            const resultsDiv = document.getElementById('batchResults');
            const sourceBadge = source === 'python' ? 
                '<span class="badge bg-success mb-2"><i class="fas fa-server me-1"></i>Python Backend</span>' :
                '<span class="badge bg-warning mb-2"><i class="fas fa-desktop me-1"></i>Local Analysis</span>';
            
            let html = `
                <div class="text-center mb-3">
                    ${sourceBadge}
                </div>
                <div class="accordion batch-accordion" id="batchResultsAccordion">
            `;
            
            results.forEach((result, index) => {
                const truthPercentage = (result.truth_percentage * 100).toFixed(1);
                const statusClass = result.needs_correction ? 'text-warning' : 'text-success';
                const statusIcon = result.needs_correction ? 'fa-exclamation-triangle' : 'fa-check-circle';
                
                html += `
                    <div class="accordion-item mb-2">
                        <h2 class="accordion-header" id="heading${index}">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                                    data-bs-target="#collapse${index}" aria-expanded="false" aria-controls="collapse${index}"
                                    style="flex-direction: column; align-items: flex-start; padding: 1rem;">
                                <div class="d-flex justify-content-between align-items-center w-100 mb-2">
                                    <div class="flex-grow-1 me-3" style="min-width: 0;">
                                        <span class="fw-bold text-dark" style="word-break: break-word; line-height: 1.4;">
                                            ${result.statement.length > 80 ? result.statement.substring(0, 80) + '...' : result.statement}
                                        </span>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <span class="badge bg-${truthPercentage >= 80 ? 'success' : truthPercentage >= 50 ? 'warning' : 'danger'} me-2">
                                            ${truthPercentage}%
                                        </span>
                                        <i class="fas ${statusIcon} ${statusClass}"></i>
                                    </div>
                                </div>
                                ${result.statement.length > 80 ? 
                                    `<small class="text-muted w-100" style="word-break: break-word;">${result.statement}</small>` : 
                                    ''
                                }
                            </button>
                        </h2>
                        <div id="collapse${index}" class="accordion-collapse collapse" 
                             aria-labelledby="heading${index}" data-bs-parent="#batchResultsAccordion">
                            <div class="accordion-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="card h-100">
                                            <div class="card-header bg-light">
                                                <h6 class="mb-0"><i class="fas fa-exclamation-triangle text-warning me-2"></i>ê°ì§€ëœ ë¬¸ì œ</h6>
                                            </div>
                                            <div class="card-body">
                                                ${result.detected_issues && result.detected_issues.length > 0 ? 
                                                    '<ul class="list-unstyled mb-0">' + result.detected_issues.map(issue => 
                                                        `<li class="mb-2"><i class="fas fa-exclamation-circle text-warning me-2"></i>${issue}</li>`
                                                    ).join('') + '</ul>' :
                                                    '<p class="text-success mb-0"><i class="fas fa-check-circle me-2"></i>ë¬¸ì œ ì—†ìŒ</p>'
                                                }
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card h-100">
                                            <div class="card-header bg-light">
                                                <h6 class="mb-0"><i class="fas fa-edit text-info me-2"></i>êµì • ì œì•ˆ</h6>
                                            </div>
                                            <div class="card-body">
                                                ${result.correction_suggestions && result.correction_suggestions.length > 0 ? 
                                                    '<div class="form-check-group">' + result.correction_suggestions.map((correction, idx) => 
                                                        `<div class="form-check mb-2">
                                                            <input class="form-check-input" type="checkbox" value="" id="correction${index}_${idx}" checked>
                                                            <label class="form-check-label" for="correction${index}_${idx}" style="word-break: break-word;">
                                                                ${correction.statement}
                                                            </label>
                                                        </div>`
                                                    ).join('') + '</div>' :
                                                    '<p class="text-muted mb-0"><i class="fas fa-info-circle me-2"></i>êµì • ë¶ˆí•„ìš”</p>'
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            resultsDiv.innerHTML = html;
        }
        
        // í™˜ê²½ ì •ë³´ í‘œì‹œ í•¨ìˆ˜
        function showEnvironmentInfo(environment) {
            const environmentInfo = {
                'github-pages': {
                    title: 'ğŸŒ GitHub Pages í™˜ê²½',
                    message: 'ë¡œì»¬ ë¶„ì„ ëª¨ë“œë¡œ ì‘ë™í•©ë‹ˆë‹¤. íŒŒì´ì¬ ë°±ì—”ë“œì˜ ê³ ê¸‰ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•˜ì„¸ìš”.',
                    type: 'info',
                    icon: 'fas fa-globe'
                },
                'local': {
                    title: 'ğŸ’» ë¡œì»¬ í™˜ê²½',
                    message: 'í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„ ëª¨ë“œë¡œ ì‘ë™í•©ë‹ˆë‹¤. íŒŒì´ì¬ ë°±ì—”ë“œê°€ ì‹¤í–‰ ì¤‘ì´ë©´ ê³ ê¸‰ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤.',
                    type: 'success',
                    icon: 'fas fa-desktop'
                }
            };
            
            const info = environmentInfo[environment];
            if (!info) return;
            
            // í† ìŠ¤íŠ¸ ì•Œë¦¼ìœ¼ë¡œ í™˜ê²½ ì •ë³´ í‘œì‹œ
            const toast = document.createElement('div');
            toast.className = `toast align-items-center text-white bg-${info.type === 'info' ? 'info' : 'success'} border-0`;
            toast.setAttribute('role', 'alert');
            toast.setAttribute('aria-live', 'assertive');
            toast.setAttribute('aria-atomic', 'true');
            toast.style.position = 'fixed';
            toast.style.top = '20px';
            toast.style.right = '20px';
            toast.style.zIndex = '9999';
            toast.style.minWidth = '300px';
            
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">
                        <i class="${info.icon} me-2"></i>
                        <strong>${info.title}</strong><br>
                        ${info.message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="ë‹«ê¸°"></button>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            // Bootstrap í† ìŠ¤íŠ¸ ì´ˆê¸°í™” ë° í‘œì‹œ
            const bsToast = new bootstrap.Toast(toast, {
                autohide: true,
                delay: 5000
            });
            bsToast.show();
            
            // í† ìŠ¤íŠ¸ê°€ ìˆ¨ê²¨ì§„ í›„ DOMì—ì„œ ì œê±°
            toast.addEventListener('hidden.bs.toast', () => {
                if (toast.parentNode) {
                    toast.remove();
                }
            });
        }
</script>
</body>
</html>